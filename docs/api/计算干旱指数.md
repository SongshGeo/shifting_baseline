---
title: 计算干旱指数
---

## 函数解读

- `precips_mm` 降水数据，单位 mm
- `pet_mm` 潜在蒸散发数据，单位 mm
- `scale` 滑动平均时间尺度；因为气象的干旱可能有一段时间的累积才能产生实际的干旱与洪涝影响，所以需要滑动平均1,3,6,12。通常使用的参数为3或者6，或者12。这里我可以调优，因为在历史1000年数据中，我们并不知道多久的干旱才能导致历史记载。
- `distribution` 分布类型，这里SPEI常用的应该是 Pearson III 分布。另一个干旱指数SPI常用的分布是Gamma分布 [@stagge2015]。
- `periodicity` 周期性，`Periodicity.monthly` 月尺度，设置12个月就行了。
- `data_start_year` 数据起始年份。
- `calibration_year_initial` 校准起始年份。通常要求大于30年，但历史千年数据中，我们并不知道气候大循环的影响，所以我们应该先检验稳态。
- `calibration_year_final` 校准结束年份。

```python
indices.spei(
        precips_mm=precip,
        pet_mm=pet,
        scale=1,
        distribution=Distribution.gamma,
        periodicity=Periodicity.monthly,
        data_start_year=850,
        calibration_year_initial=850,
        calibration_year_final=1850,
    )
```
